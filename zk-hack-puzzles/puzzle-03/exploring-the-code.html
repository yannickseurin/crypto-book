<!DOCTYPE HTML>
<html lang="en" class="rust" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Exploring the Code - Crypto Book (Work in Progress)</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../.././assets/custom.css">
        <link rel="stylesheet" href="../../theme/pagetoc.css">
        <link rel="stylesheet" href="../.././assets/mdbook-admonish.css">
        <link rel="stylesheet" href="../.././assets/mdbook-admonish-custom.css">

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "ayu" : "rust";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('rust')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item affix "><a href="../../intro.html">Introduction</a></li><li class="chapter-item affix "><li class="part-title">Mathematical Preliminaries</li><li class="chapter-item "><a href="../../mathematical-preliminaries/groups.html"><strong aria-hidden="true">1.</strong> Groups</a></li><li class="chapter-item "><div><strong aria-hidden="true">2.</strong> Rings</div></li><li class="chapter-item "><a href="../../mathematical-preliminaries/polynomials.html"><strong aria-hidden="true">3.</strong> Polynomials</a></li><li class="chapter-item "><div><strong aria-hidden="true">4.</strong> Fields</div></li><li class="chapter-item "><div><strong aria-hidden="true">5.</strong> Fast Fourier Transform</div></li><li class="chapter-item "><a href="../../mathematical-preliminaries/elliptic-curves.html"><strong aria-hidden="true">6.</strong> Elliptic Curves</a></li><li class="chapter-item "><a href="../../mathematical-preliminaries/pairings.html"><strong aria-hidden="true">7.</strong> Pairings</a></li><li class="chapter-item affix "><li class="part-title">Cryptographic Notions</li><li class="chapter-item "><a href="../../cryptographic-notions/games-models-and-assumptions.html"><strong aria-hidden="true">8.</strong> Games, Models, and Assumptions</a></li><li class="chapter-item "><div><strong aria-hidden="true">9.</strong> Signatures: Generalities</div></li><li class="chapter-item "><div><strong aria-hidden="true">10.</strong> Schnorr Signatures</div></li><li class="chapter-item "><div><strong aria-hidden="true">11.</strong> ECDSA Signatures</div></li><li class="chapter-item "><a href="../../cryptographic-notions/bls-signatures.html"><strong aria-hidden="true">12.</strong> BLS Signatures</a></li><li class="chapter-item "><a href="../../cryptographic-notions/commitment-schemes.html"><strong aria-hidden="true">13.</strong> Commitment Schemes</a></li><li class="chapter-item "><a href="../../cryptographic-notions/polynomial-commitment-schemes.html"><strong aria-hidden="true">14.</strong> Polynomial Commitment Schemes</a></li><li class="chapter-item affix "><li class="part-title">Proof Systems</li><li class="chapter-item "><div><strong aria-hidden="true">15.</strong> Languages and Complexity</div></li><li class="chapter-item "><div><strong aria-hidden="true">16.</strong> Interactive Proofs</div></li><li class="chapter-item "><div><strong aria-hidden="true">17.</strong> Zero-Knowledge Proofs</div></li><li class="chapter-item "><div><strong aria-hidden="true">18.</strong> Proofs of Knowledge</div></li><li class="chapter-item affix "><li class="part-title">ZK Hack Puzzles</li><li class="chapter-item "><a href="../../zk-hack-puzzles/before-starting.html"><strong aria-hidden="true">19.</strong> Before Starting</a></li><li class="chapter-item "><a href="../../zk-hack-puzzles/puzzle-01/intro.html"><strong aria-hidden="true">20.</strong> Puzzle 1: Let's Hash it Out</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../zk-hack-puzzles/puzzle-01/initial-inspection.html"><strong aria-hidden="true">20.1.</strong> Initial Inspection</a></li><li class="chapter-item "><a href="../../zk-hack-puzzles/puzzle-01/exploring-the-arkworks-libraries.html"><strong aria-hidden="true">20.2.</strong> Exploring the arkworks Libraries</a></li><li class="chapter-item "><a href="../../zk-hack-puzzles/puzzle-01/understanding-the-hash-to-curve-function.html"><strong aria-hidden="true">20.3.</strong> Understanding the hash-to-curve Function</a></li><li class="chapter-item "><a href="../../zk-hack-puzzles/puzzle-01/gathering-the-pieces.html"><strong aria-hidden="true">20.4.</strong> Gathering the Pieces</a></li></ol></li><li class="chapter-item "><a href="../../zk-hack-puzzles/puzzle-02/intro.html"><strong aria-hidden="true">21.</strong> Puzzle 2: Group Dynamics</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../zk-hack-puzzles/puzzle-02/initial-inspection.html"><strong aria-hidden="true">21.1.</strong> Initial Inspection</a></li><li class="chapter-item "><a href="../../zk-hack-puzzles/puzzle-02/small-subgroup-attacks.html"><strong aria-hidden="true">21.2.</strong> Small Subgroup Attacks</a></li><li class="chapter-item "><a href="../../zk-hack-puzzles/puzzle-02/solving-the-puzzle.html"><strong aria-hidden="true">21.3.</strong> Solving the Puzzle</a></li></ol></li><li class="chapter-item expanded "><a href="../../zk-hack-puzzles/puzzle-03/intro.html"><strong aria-hidden="true">22.</strong> Puzzle 3: Double Trouble</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../zk-hack-puzzles/puzzle-03/initial-inspection.html"><strong aria-hidden="true">22.1.</strong> Initial Inspection</a></li><li class="chapter-item expanded "><a href="../../zk-hack-puzzles/puzzle-03/exploring-the-code.html" class="active"><strong aria-hidden="true">22.2.</strong> Exploring the Code</a></li><li class="chapter-item "><a href="../../zk-hack-puzzles/puzzle-03/solving-the-puzzle.html"><strong aria-hidden="true">22.3.</strong> Solving the Puzzle</a></li></ol></li><li class="chapter-item "><div><strong aria-hidden="true">23.</strong> Puzzle 4: Hidden in Plain Sight</div></li><li class="chapter-item "><div><strong aria-hidden="true">24.</strong> Puzzle 5: To be Adaptive is to be Strong</div></li><li class="chapter-item "><div><strong aria-hidden="true">25.</strong> Puzzle 6: Soundness of Music</div></li><li class="chapter-item "><div><strong aria-hidden="true">26.</strong> Puzzle 7: There’s something in the AIR</div></li><li class="chapter-item "><div><strong aria-hidden="true">27.</strong> Puzzle 8: Can you turn up the heat?</div></li><li class="chapter-item "><div><strong aria-hidden="true">28.</strong> Puzzle 9: Zero-Sum Game</div></li><li class="chapter-item "><div><strong aria-hidden="true">29.</strong> Puzzle 10: Power Corrupts</div></li><li class="chapter-item "><div><strong aria-hidden="true">30.</strong> Puzzle 11: Bigger is Better</div></li><li class="chapter-item "><a href="../../zk-hack-puzzles/puzzle-12/intro.html"><strong aria-hidden="true">31.</strong> Puzzle 12: Gamma Ray</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../zk-hack-puzzles/puzzle-12/code-analysis.html"><strong aria-hidden="true">31.1.</strong> Code Analysis</a></li><li class="chapter-item "><a href="../../zk-hack-puzzles/puzzle-12/understanding-the-spending-circuit.html"><strong aria-hidden="true">31.2.</strong> Understanding the Spending Circuit</a></li><li class="chapter-item "><a href="../../zk-hack-puzzles/puzzle-12/solving-the-puzzle.html"><strong aria-hidden="true">31.3.</strong> Solving the Puzzle</a></li></ol></li><li class="chapter-item "><a href="../../zk-hack-puzzles/puzzle-13/puzzle-13.html"><strong aria-hidden="true">32.</strong> Puzzle 13: Supervillain</a></li><li class="chapter-item "><a href="../../zk-hack-puzzles/puzzle-14/puzzle-14.html"><strong aria-hidden="true">33.</strong> Puzzle 14: Chaos Theory</a></li><li class="chapter-item affix "><a href="../../references.html">References</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Crypto Book (Work in Progress)</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/yannickseurin/crypto-book" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <div class="content-wrap">
                            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h2 id="exploring-the-code"><a class="header" href="#exploring-the-code">Exploring the Code</a></h2>
<p>Let us recall the proof system here before digging into the code:</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:30.051em;vertical-align:-14.7755em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:15.2755em;"><span style="top:-32.051em;"><span class="pstrut" style="height:32.051em;"></span><span class="boxpad"><span class="mord"><span class="mord"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:14.9355em;"><span style="top:-16.9355em;"><span class="pstrut" style="height:16.9355em;"></span><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:14.9355em;"><span style="top:-17.2328em;"><span class="pstrut" style="height:3.3053em;"></span><span class="mord"><span class="mord text"><span class="mord">Prover</span></span></span></span><span style="top:-15.7928em;"><span class="pstrut" style="height:3.3053em;"></span><span class="mord"><span class="mord text"><span class="mord">parameters: </span></span><span class="mopen">(</span><span class="mord mathbb">G</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathbf">G</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mclose">)</span></span></span><span style="top:-14.3528em;"><span class="pstrut" style="height:3.3053em;"></span><span class="mord"><span class="mord text"><span class="mord">instance: </span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathbf">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathbb">G</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathbb">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span><span style="top:-12.9128em;"><span class="pstrut" style="height:3.3053em;"></span><span class="mord"><span class="mord text"><span class="mord">witness: </span></span><span class="mopen">(</span><span class="mord mathbf">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathbb">G</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathbb">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:-11.4728em;"><span class="pstrut" style="height:3.3053em;"></span><span class="mord"><span class="mord text"><span class="mord">relation: </span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">⟨</span><span class="mord mathbf">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathbf">G</span><span class="mclose">⟩</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span></span></span><span style="top:-10.0328em;"><span class="pstrut" style="height:3.3053em;"></span><span class="mord"><span class="mord mathbf">r</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel">←</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">$</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2191em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathbb">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span><span style="top:-8.5928em;"><span class="pstrut" style="height:3.3053em;"></span><span class="mord"><span class="mord mathnormal">ρ</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.06366em;">ν</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel">←</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">$</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2191em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathbb">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:-7.1528em;"><span class="pstrut" style="height:3.3053em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mop" style="position:relative;top:-0.0347em;">:</span></span><span class="mrel"><span class="mspace" style="margin-right:-0.0667em;"></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">⟨</span><span class="mord mathbf">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathbf">G</span><span class="mclose">⟩</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">ρ</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span></span></span><span style="top:-5.7128em;"><span class="pstrut" style="height:3.3053em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mop" style="position:relative;top:-0.0347em;">:</span></span><span class="mrel"><span class="mspace" style="margin-right:-0.0667em;"></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">⟨</span><span class="mord mathbf">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathbf">b</span><span class="mclose">⟩</span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span></span></span><span style="top:-4.2728em;"><span class="pstrut" style="height:3.3053em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mop" style="position:relative;top:-0.0347em;">:</span></span><span class="mrel"><span class="mspace" style="margin-right:-0.0667em;"></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">⟨</span><span class="mord mathbf">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathbf">b</span><span class="mclose">⟩</span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.06366em;">ν</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span></span></span><span style="top:-2.5355em;"><span class="pstrut" style="height:3.3053em;"></span><span class="mord"></span></span><span style="top:-1.0955em;"><span class="pstrut" style="height:3.3053em;"></span><span class="mord"></span></span><span style="top:0.3891em;"><span class="pstrut" style="height:3.3053em;"></span><span class="mord"></span></span><span style="top:1.8291em;"><span class="pstrut" style="height:3.3053em;"></span><span class="mord"><span class="mord mathbf">s</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mop" style="position:relative;top:-0.0347em;">:</span></span><span class="mrel"><span class="mspace" style="margin-right:-0.0667em;"></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathbf">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mord mathbf">r</span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span><span style="top:3.2691em;"><span class="pstrut" style="height:3.3053em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mop" style="position:relative;top:-0.0347em;">:</span></span><span class="mrel"><span class="mspace" style="margin-right:-0.0667em;"></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mord mathnormal">ρ</span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span><span style="top:4.7091em;"><span class="pstrut" style="height:3.3053em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mop" style="position:relative;top:-0.0347em;">:</span></span><span class="mrel"><span class="mspace" style="margin-right:-0.0667em;"></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mord mathnormal" style="margin-right:0.06366em;">ν</span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span><span style="top:6.3782em;"><span class="pstrut" style="height:3.3053em;"></span><span class="mord"></span></span><span style="top:7.8182em;"><span class="pstrut" style="height:3.3053em;"></span><span class="mord"></span></span><span style="top:9.2582em;"><span class="pstrut" style="height:3.3053em;"></span><span class="mord"></span></span><span style="top:10.6982em;"><span class="pstrut" style="height:3.3053em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:14.4355em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:14.9355em;"><span style="top:-17.2328em;"><span class="pstrut" style="height:3.3053em;"></span><span class="mord"></span></span><span style="top:-15.7928em;"><span class="pstrut" style="height:3.3053em;"></span><span class="mord"></span></span><span style="top:-14.3528em;"><span class="pstrut" style="height:3.3053em;"></span><span class="mord"></span></span><span style="top:-12.9128em;"><span class="pstrut" style="height:3.3053em;"></span><span class="mord"></span></span><span style="top:-11.4728em;"><span class="pstrut" style="height:3.3053em;"></span><span class="mord"></span></span><span style="top:-10.0328em;"><span class="pstrut" style="height:3.3053em;"></span><span class="mord"></span></span><span style="top:-8.5928em;"><span class="pstrut" style="height:3.3053em;"></span><span class="mord"></span></span><span style="top:-7.1528em;"><span class="pstrut" style="height:3.3053em;"></span><span class="mord"></span></span><span style="top:-5.7128em;"><span class="pstrut" style="height:3.3053em;"></span><span class="mord"></span></span><span style="top:-4.2728em;"><span class="pstrut" style="height:3.3053em;"></span><span class="mord"></span></span><span style="top:-2.5355em;"><span class="pstrut" style="height:3.3053em;"></span><span class="mord"><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3053em;"><span style="top:-3.622em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight x-arrow-pad"><span class="mord mtight"><span class="mspace sizing reset-size3 size6"> </span><span class="mord sizing reset-size3 size6"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct sizing reset-size3 size6">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord sizing reset-size3 size6"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct sizing reset-size3 size6">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord sizing reset-size3 size6"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace sizing reset-size3 size6"> </span></span></span></span><span class="svg-align" style="top:-2.989em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="height:0.522em;min-width:1.469em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'><path d='M0 241v40h399891c-47.3 35.3-84 78-110 128 -16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20  11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7  39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85 -40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5 -12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67  151.7 139 205zm0 0v40h399900v-40z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.011em;"><span></span></span></span></span></span></span></span><span style="top:-1.0955em;"><span class="pstrut" style="height:3.3053em;"></span><span class="mord"></span></span><span style="top:0.3891em;"><span class="pstrut" style="height:3.3053em;"></span><span class="mord"><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0526em;"><span style="top:-3.622em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight x-arrow-pad"><span class="mord mtight"><span class="mspace sizing reset-size3 size6" style="margin-right:2em;"></span><span class="mord mathnormal sizing reset-size3 size6" style="margin-right:0.05556em;">γ</span><span class="mspace sizing reset-size3 size6" style="margin-right:2em;"></span></span></span></span><span class="svg-align" style="top:-2.989em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="height:0.522em;min-width:1.469em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMinYMin slice'><path d='M400000 241H110l3-3c68.7-52.7 113.7-120  135-202 4-14.7 6-23 6-25 0-7.3-7-11-21-11-8 0-13.2.8-15.5 2.5-2.3 1.7-4.2 5.8 -5.5 12.5-1.3 4.7-2.7 10.3-4 17-12 48.7-34.8 92-68.5 130S65.3 228.3 18 247 c-10 4-16 7.7-18 11 0 8.7 6 14.3 18 17 47.3 18.7 87.8 47 121.5 85S196 441.3 208  490c.7 2 1.3 5 2 9s1.2 6.7 1.5 8c.3 1.3 1 3.3 2 6s2.2 4.5 3.5 5.5c1.3 1 3.3  1.8 6 2.5s6 1 10 1c14 0 21-3.7 21-11 0-2-2-10.3-6-25-20-79.3-65-146.7-135-202  l-3-3h399890zM100 241v40h399900v-40z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.011em;"><span></span></span></span></span></span></span></span><span style="top:1.8291em;"><span class="pstrut" style="height:3.3053em;"></span><span class="mord"></span></span><span style="top:3.2691em;"><span class="pstrut" style="height:3.3053em;"></span><span class="mord"></span></span><span style="top:4.7091em;"><span class="pstrut" style="height:3.3053em;"></span><span class="mord"></span></span><span style="top:6.3782em;"><span class="pstrut" style="height:3.3053em;"></span><span class="mord"><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2371em;"><span style="top:-3.622em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight x-arrow-pad"><span class="mord mtight"><span class="mspace sizing reset-size3 size6" style="margin-right:1em;"></span><span class="mord mathbf sizing reset-size3 size6">s</span><span class="mpunct sizing reset-size3 size6">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal sizing reset-size3 size6">u</span><span class="mpunct sizing reset-size3 size6">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal sizing reset-size3 size6">t</span><span class="mspace sizing reset-size3 size6" style="margin-right:1em;"></span></span></span></span><span class="svg-align" style="top:-2.989em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="height:0.522em;min-width:1.469em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'><path d='M0 241v40h399891c-47.3 35.3-84 78-110 128 -16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20  11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7  39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85 -40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5 -12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67  151.7 139 205zm0 0v40h399900v-40z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.011em;"><span></span></span></span></span></span></span></span><span style="top:7.8182em;"><span class="pstrut" style="height:3.3053em;"></span><span class="mord"></span></span><span style="top:9.2582em;"><span class="pstrut" style="height:3.3053em;"></span><span class="mord"></span></span><span style="top:10.6982em;"><span class="pstrut" style="height:3.3053em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:14.4355em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:14.9355em;"><span style="top:-16.98em;"><span class="pstrut" style="height:3.0526em;"></span><span class="mord"><span class="mord text"><span class="mord">Verifier</span></span></span></span><span style="top:-15.54em;"><span class="pstrut" style="height:3.0526em;"></span><span class="mord"><span class="mord text"><span class="mord">parameters: </span></span><span class="mopen">(</span><span class="mord mathbb">G</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathbf">G</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mclose">)</span></span></span><span style="top:-14.1em;"><span class="pstrut" style="height:3.0526em;"></span><span class="mord"><span class="mord text"><span class="mord">instance: </span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathbf">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathbb">G</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathbb">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span><span style="top:-12.66em;"><span class="pstrut" style="height:3.0526em;"></span><span class="mord"></span></span><span style="top:-11.22em;"><span class="pstrut" style="height:3.0526em;"></span><span class="mord"></span></span><span style="top:-9.78em;"><span class="pstrut" style="height:3.0526em;"></span><span class="mord"></span></span><span style="top:-8.34em;"><span class="pstrut" style="height:3.0526em;"></span><span class="mord"></span></span><span style="top:-6.9em;"><span class="pstrut" style="height:3.0526em;"></span><span class="mord"></span></span><span style="top:-5.46em;"><span class="pstrut" style="height:3.0526em;"></span><span class="mord"></span></span><span style="top:-4.02em;"><span class="pstrut" style="height:3.0526em;"></span><span class="mord"></span></span><span style="top:-0.8427em;"><span class="pstrut" style="height:3.0526em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel">←</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">$</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2191em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathbb">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:0.6418em;"><span class="pstrut" style="height:3.0526em;"></span><span class="mord"></span></span><span style="top:2.0818em;"><span class="pstrut" style="height:3.0526em;"></span><span class="mord"></span></span><span style="top:3.5218em;"><span class="pstrut" style="height:3.0526em;"></span><span class="mord"></span></span><span style="top:4.9618em;"><span class="pstrut" style="height:3.0526em;"></span><span class="mord"></span></span><span style="top:8.0709em;"><span class="pstrut" style="height:3.0526em;"></span><span class="mord"><span class="mord text"><span class="mord">check that</span></span></span></span><span style="top:9.5109em;"><span class="pstrut" style="height:3.0526em;"></span><span class="mord"><span class="mopen">⟨</span><span class="mord mathbf">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathbf">G</span><span class="mclose">⟩</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">u</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:10.9509em;"><span class="pstrut" style="height:3.0526em;"></span><span class="mord"><span class="mopen">⟨</span><span class="mord mathbf">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathbf">b</span><span class="mclose">⟩</span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:14.4355em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span><span style="top:-24.671em;"><span class="pstrut" style="height:16.9355em;"></span><span class="hline" style="border-bottom-width:0.04em;"></span></span><span style="top:-30.431em;"><span class="pstrut" style="height:16.9355em;"></span><span class="hline" style="border-bottom-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:14.4355em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-17.2755em;"><span class="pstrut" style="height:32.051em;"></span><span class="stretchy fbox" style="height:30.051em;border-style:solid;border-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:14.7755em;"><span></span></span></span></span></span></span></span></span></span></p>
<p>The package directory is organized as follows:</p>
<pre><code class="language-text">zkhack-double-trouble
├── Cargo.toml
└── src
    ├── bin
    │   └── verify-double-trouble.rs
    ├── inner_product_argument
    │   ├── data_structures.rs
    │   └── utils.rs
    ├── data.rs
    ├── inner_product_argument.rs
    └── lib.rs
</code></pre>
<p>The proof system is implemented in the <code>inner_product_argument</code> module of the library crate and follows closely the specification from the puzzle's description.
The puzzle uses the <a href="https://docs.rs/ark-ed-on-bls12-381/0.3.0/ark_ed_on_bls12_381/">ark-ed-on-bls12-381</a> library which implements the so-called <a href="https://neuromancer.sk/std/other/JubJub/">Jubjub curve</a> developed by the Zcash team.
This curve was designed to have its base field equal to the scalar field of BLS12-381, allowing to efficiently prove statements about cryptographic schemes based on Jubjub (such a Pedersen commitments, Schnorr signatures, etc) using a proof system based on BLS12-381.
The affine group and the scalar field of this curve are brought into scope with</p>
<pre><code class="language-rust">use ark_ed_on_bls12_381::{EdwardsAffine as GAffine, Fr};</code></pre>
<p>Two structures <code>Instance</code> and <code>Witness</code> corresponding respectively to the instance <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathbf">b</span><span class="mclose">)</span></span></span></span> and the witness <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathbf">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mclose">)</span></span></span></span> are defined directly in <em>src/inner_product_argument.rs</em>:</p>
<pre><code class="language-rust">pub struct Instance {
    pub comm_a: GAffine,
    pub b: Vec&lt;Fr&gt;,
}

pub struct Witness {
    pub a: Vec&lt;Fr&gt;,
    pub comm_a_rand: Fr,
}</code></pre>
<p>Four additional structures are defined in <em>src/inner_product_argument/data_structures.rs</em>:</p>
<ul>
<li>the commitment key <code>CommitKey</code> <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.589em;"></span><span class="mrel">≅</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathbf">G</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mclose">)</span><span class="mpunct">,</span></span></span></span></li>
<li>the proof commitment (first message sent by the prover in the interactive protocol) <code>ProofCommitment</code> <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.589em;"></span><span class="mrel">≅</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span></span></span></span></li>
<li>the proof response (second message sent by the prover in the interactive protocol) <code>ProofResponse</code> <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.589em;"></span><span class="mrel">≅</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathbf">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mpunct">,</span></span></span></span></li>
<li>and a fourth structure <code>Proof</code> which simply combines <code>ProofCommitment</code> and <code>ProofResponse</code>.</li>
</ul>
<p>Here is the code defining these four structures:</p>
<pre><code class="language-rust">pub struct CommitKey {
    pub generators: Vec&lt;GAffine&gt;,
    pub hiding_generator: GAffine,
}

pub struct ProofCommitment {
    pub comm_r: GAffine,
    pub comm_1: GAffine,
    pub comm_2: GAffine,
}

pub struct ProofResponse {
    pub s: Vec&lt;Fr&gt;,
    pub u: Fr,
    pub t: Fr,
}

pub struct Proof {
    pub commitment: ProofCommitment,
    pub response: ProofResponse,
}</code></pre>
<p>The rest of the code in the <code>inner_product_argument</code> module and sub-modules does not show anything surprising.
As said in the puzzle description, the proof system is made non-interactive using the Fiat-Shamir transform.
Namely, the challenge <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span></span></span></span> is computed by hashing the commitment key, the instance, and the commitment:</p>
<pre><code class="language-rust">    let challenge = challenge(ck, instance, &amp;commitment);</code></pre>
<p>where function <code>challenge</code> is defined in <em>inner_product_argument/utils.rs</em>:</p>
<pre><code class="language-rust">pub fn b2s_hash_to_field&lt;C: CanonicalSerialize&gt;(input: &amp;C) -&gt; Fr {
    let bytes = input.hash::&lt;blake2::Blake2s&gt;();
    Fr::from_le_bytes_mod_order(&amp;bytes)
}

pub fn challenge(ck: &amp;CommitKey, instance: &amp;Instance, proof_comm: &amp;ProofCommitment) -&gt; Fr {
    b2s_hash_to_field(&amp;(ck.clone(), instance.clone(), proof_comm.clone()))
}</code></pre>
<p>Let's take a look at the binary crate and its <code>main</code> function:</p>
<pre><code class="language-rust">fn main() {
    welcome();
    puzzle(PUZZLE_DESCRIPTION);
    let (ck, [instance_and_proof_1, instance_and_proof_2]) = puzzle_data();
    let (instance1, proof1) = instance_and_proof_1;
    let (instance2, proof2) = instance_and_proof_2;
    assert!(verify(&amp;ck, &amp;instance1, &amp;proof1));
    assert!(verify(&amp;ck, &amp;instance2, &amp;proof2));

    let (a, comm_a_rand): (Vec&lt;Fr&gt;, Fr) = {
        // Your solution here!
        todo!()
    };
    assert_eq!(
        ck.commit_with_explicit_randomness(&amp;a, comm_a_rand),
        instance1.comm_a
    );
    assert_eq!(
        ck.commit_with_explicit_randomness(&amp;a, comm_a_rand),
        instance2.comm_a
    );
}</code></pre>
<p>The <code>puzzle_data</code> function simply deserializes some data and returns a commitment key <code>ck</code> and two instance/proof pairs.
We can print the structures we're interested in:</p>
<pre><code class="language-rust"><span class="boring">#![allow(unused, unreachable_code)]
</span><span class="boring">use ark_ed_on_bls12_381::Fr;
</span><span class="boring">use ark_ff::Field;
</span><span class="boring">use double_trouble::data::puzzle_data;
</span><span class="boring">use double_trouble::inner_product_argument::utils::challenge;
</span><span class="boring">use double_trouble::verify;
</span><span class="boring">use double_trouble::PUZZLE_DESCRIPTION;
</span><span class="boring">use prompt::{puzzle, welcome};
</span><span class="boring">
</span><span class="boring">// additional items brought into scope for puzzle solving
</span><span class="boring">use double_trouble::CommitKey;
</span><span class="boring">use ark_ec::AffineCurve;
</span><span class="boring">
</span><span class="boring">fn main() {
</span><span class="boring">    welcome();
</span><span class="boring">    puzzle(PUZZLE_DESCRIPTION);
</span><span class="boring">    let (ck, [instance_and_proof_1, instance_and_proof_2]) = puzzle_data();
</span><span class="boring">    let (instance1, proof1) = instance_and_proof_1;
</span><span class="boring">    let (instance2, proof2) = instance_and_proof_2;
</span><span class="boring">    assert!(verify(&amp;ck, &amp;instance1, &amp;proof1));
</span><span class="boring">    assert!(verify(&amp;ck, &amp;instance2, &amp;proof2));
</span><span class="boring">
</span>    // --snip--

    println!("commitment key:");
    for (i, ck_i) in ck.generators.iter().enumerate() {
        println!("ck.generators[{}] = {}", i, ck_i);
    }
    println!("ck.hiding_generator = {}\n", ck.hiding_generator);
    println!("instance 1, C_a:\n {}\n", instance1.comm_a);
    println!("instance 2, C_a:\n {}\n", instance2.comm_a);
    println!("instance 1, b:");
    for (i, b_i) in instance1.b.iter().enumerate() {
        println!("instance1.b[{}] = {}", i, b_i);
    }
    println!("");
    println!("instance 2, b:");
    for (i, b_i) in instance2.b.iter().enumerate() {
        println!("instance2.b[{}] = {}", i, b_i);
    }
    println!("");
<span class="boring">
</span><span class="boring">    // --snip--
</span><span class="boring">
</span><span class="boring">    assert_eq!(instance1, instance2);
</span><span class="boring">    assert_eq!(ck, CommitKey::sample(8));
</span><span class="boring">
</span><span class="boring">    // --snip--
</span><span class="boring">
</span><span class="boring">    println!("proof1, comm_r:\n {}", proof1.commitment.comm_r);
</span><span class="boring">    println!("proof1, comm_1:\n {}", proof1.commitment.comm_1);
</span><span class="boring">    println!("proof1, comm_2:\n {}\n", proof1.commitment.comm_2);
</span><span class="boring">
</span><span class="boring">    println!("proof2, comm_r:\n {}", proof2.commitment.comm_r);
</span><span class="boring">    println!("proof2, comm_1:\n {}", proof2.commitment.comm_1);
</span><span class="boring">    println!("proof2, comm_2:\n {}\n", proof2.commitment.comm_2);
</span><span class="boring">
</span><span class="boring">    // --snip--
</span><span class="boring">
</span><span class="boring">    if proof1.commitment.comm_r.mul(2) == proof2.commitment.comm_r {
</span><span class="boring">        println!("C_r in the second proof is twice C_r in the first proof\n");
</span><span class="boring">    }
</span><span class="boring">
</span><span class="boring">    // --snip--
</span><span class="boring">
</span><span class="boring">    let gamma1 = challenge(&amp;ck, &amp;instance1, &amp;proof1.commitment);
</span><span class="boring">    let gamma2 = challenge(&amp;ck, &amp;instance2, &amp;proof2.commitment);
</span><span class="boring">    let s1 = proof1.response.s;
</span><span class="boring">    let s2 = proof2.response.s;
</span><span class="boring">    let u1 = proof1.response.u;
</span><span class="boring">    let u2 = proof2.response.u;
</span><span class="boring">    let k = (gamma1 - Fr::from(2) * gamma2).inverse().unwrap();
</span><span class="boring">    let my_a: Vec&lt;Fr&gt; = s1
</span><span class="boring">        .iter()
</span><span class="boring">        .zip(s2.iter())
</span><span class="boring">        .map(|(c1, c2)| k * (gamma1 * c2 - Fr::from(2) * gamma2 * c1))
</span><span class="boring">        .collect();
</span><span class="boring">    let my_comm_a_rand = k * (gamma1 * u2 - Fr::from(2) * gamma2 * u1);
</span><span class="boring">
</span><span class="boring">    let (a, comm_a_rand): (Vec&lt;Fr&gt;, Fr) = {
</span><span class="boring">        // Your solution here!
</span><span class="boring">        (my_a, my_comm_a_rand)
</span><span class="boring">    };
</span><span class="boring">    assert_eq!(
</span><span class="boring">        ck.commit_with_explicit_randomness(&amp;a, comm_a_rand),
</span><span class="boring">        instance1.comm_a
</span><span class="boring">    );
</span><span class="boring">    assert_eq!(
</span><span class="boring">        ck.commit_with_explicit_randomness(&amp;a, comm_a_rand),
</span><span class="boring">        instance2.comm_a
</span><span class="boring">    );
</span><span class="boring">    println!("Puzzle solved!");
</span><span class="boring">}</span></code></pre>
<p>We get:</p>
<pre><code class="language-text">commitment key:
ck.generators[0] = GroupAffine(x=Fp256 "(198B8C3FC05A64DF64DEC6C0C9CF997E1AFA1DBB5C191ED0DFD5C771467F089D)", y=Fp256 "(5AE26A746DDBBCC5ECC3C970E715AEC48BB2551DD9DDE8AE7A7DA7032E161577)")
ck.generators[1] = GroupAffine(x=Fp256 "(4B92D491ACE817177026CD40C5020D04B30759F240CFDFF8DD795629E3307C5E)", y=Fp256 "(6604E7622969E8E968970E74DB648CF8226DCB0B67FF8E6313A3B9CAD7353701)")
ck.generators[2] = GroupAffine(x=Fp256 "(70F5E9698EF8F51B85D089DBBCC2F25190C905F6113976696F109307D347ACBA)", y=Fp256 "(3BD293E00769FE7963674BFA0745B4FE316AF189856418E679DBEF49B00A9085)")
ck.generators[3] = GroupAffine(x=Fp256 "(3FF005D6FE8FE85EA40051BF5051464AB69F0B587BE571B2800C08F4B93AD452)", y=Fp256 "(445D24D6D0EDEFC80B3785F27613FD072E4E69EBFC6A0B9716036F19E15C6ABF)")
ck.generators[4] = GroupAffine(x=Fp256 "(5174580F00FB73C60E3CA1D0A0EBF328FDAC3A018D15F6ED81B39D833927C079)", y=Fp256 "(26053B0E29A8E735673D8ACC0C0353EA6326DF6F81A2EE0AC65A8C1A853241F5)")
ck.generators[5] = GroupAffine(x=Fp256 "(65B0213A6DE2BC0DDAD9648179372A2B3939B06A1062CF0D58F731ABF7D6B742)", y=Fp256 "(11C6904D697A2638441B3125D0A3316507A03C16D79FCB3F5A19CF3ECFD649E6)")
ck.generators[6] = GroupAffine(x=Fp256 "(50644971731D58AFB54EB92D6F0C7700F06774B2AF10E72B646C0D5A93AA6347)", y=Fp256 "(1C282A3A58C4AD917587EBE68DC84A4CAC0E4A914FA83618439373528617AAAF)")
ck.generators[7] = GroupAffine(x=Fp256 "(3181568CB6D37D00412E3348F2C08C1579DB32492A768F41EAC49D8E7E6F9BBF)", y=Fp256 "(27EDAEA9068A61645B11E8D5C15E9569340E59E3963AE78CAADD2282451F10F4)")
ck.hiding_generator = GroupAffine(x=Fp256 "(3A2ED8E0E81BED90A83FA22E58FA8A0F08752AAB03CD4BA9BB558965B9A57B32)", y=Fp256 "(3C603EF0D0BB80987AD83208034C552F8919C5F8FEACC5404DEBCC16FE3B947F)")

instance 1, C_a:
 GroupAffine(x=Fp256 "(6AE271E04FBB0AE9FB89506FF7180F5C06A8D60F802D934987965F694228BF8A)", y=Fp256 "(2BFBFA9CCF2151F01E71A069366DAD9398960B64684888D1AABB50D4D57BDF32)")

instance 2, C_a:
 GroupAffine(x=Fp256 "(6AE271E04FBB0AE9FB89506FF7180F5C06A8D60F802D934987965F694228BF8A)", y=Fp256 "(2BFBFA9CCF2151F01E71A069366DAD9398960B64684888D1AABB50D4D57BDF32)")

instance 1, b:
instance1.b[0] = Fp256 "(08180E66A534AADEBC88D09E1397DC7C33E2014115EB973B489E7D5CDBF839CD)"
instance1.b[1] = Fp256 "(036AFB822FAC04AC9191CCEEF5BF4E27ADA6DC0440C88ECF3E06DC2FAFB162E6)"
instance1.b[2] = Fp256 "(0DE7FE23DCF79F2A041E2C21876F9B9AEB3F2BC628E07B87F52DF460408334F2)"
instance1.b[3] = Fp256 "(0891BBE1E3DA5717F7ED59288C9F51186E7BBAE018C9DA56F4BC8B4BBBD7457E)"
instance1.b[4] = Fp256 "(05D81F4C416350A3D02B1685176BFE5A98FA15D51C84DBD47680326F9F005E96)"
instance1.b[5] = Fp256 "(06D5E58667508A24F3A3FFBB244575DE29ECB3408D6EBC6D3DCDEFF02AA9453C)"
instance1.b[6] = Fp256 "(06BC47A67C6BD353EE624051B4C4A6A28E7F8CEDB6ED65A007D897AC071CBDCB)"
instance1.b[7] = Fp256 "(0CF6D9D35E0B6F2309568E5BB7C19448D993D2EFFEF7B3D77C137A26C524315A)"

instance 2, b:
instance2.b[0] = Fp256 "(08180E66A534AADEBC88D09E1397DC7C33E2014115EB973B489E7D5CDBF839CD)"
instance2.b[1] = Fp256 "(036AFB822FAC04AC9191CCEEF5BF4E27ADA6DC0440C88ECF3E06DC2FAFB162E6)"
instance2.b[2] = Fp256 "(0DE7FE23DCF79F2A041E2C21876F9B9AEB3F2BC628E07B87F52DF460408334F2)"
instance2.b[3] = Fp256 "(0891BBE1E3DA5717F7ED59288C9F51186E7BBAE018C9DA56F4BC8B4BBBD7457E)"
instance2.b[4] = Fp256 "(05D81F4C416350A3D02B1685176BFE5A98FA15D51C84DBD47680326F9F005E96)"
instance2.b[5] = Fp256 "(06D5E58667508A24F3A3FFBB244575DE29ECB3408D6EBC6D3DCDEFF02AA9453C)"
instance2.b[6] = Fp256 "(06BC47A67C6BD353EE624051B4C4A6A28E7F8CEDB6ED65A007D897AC071CBDCB)"
instance2.b[7] = Fp256 "(0CF6D9D35E0B6F2309568E5BB7C19448D993D2EFFEF7B3D77C137A26C524315A)"
</code></pre>
<p>We can note a couple of interesting things.
First, points <code>instance1.comm_a</code> and <code>instance2.comm_a</code> are equal and vectors <code>instance1.b</code> and <code>instance2.b</code> are equal, meaning the two instances are exactly the same (whereas the puzzle description said that the proofs published by Bob where for different different <code>b</code> vectors).
Second, <code>ck.generators</code> (vector <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf">G</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> in the description above) has length <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">8.</span></span></span></span>
Where does this commitment key come from?
The <code>CommitKey</code> structure has an associated function allowing to sample a commitment key:</p>
<pre><code class="language-rust">impl CommitKey {
    pub fn sample(size: usize) -&gt; Self {
        let mut rng = ChaChaRng::from_seed(*b"zkHack IPA puzzle for 2021-10-26");
        let generators = sample_vector::&lt;GAffine, _&gt;(size, &amp;mut rng)
            .into_iter()
            .map(Into::into)
            .collect();
        let hiding_generator = GProjective::rand(&amp;mut rng).into();
        Self {
            generators,
            hiding_generator,
        }
    }
    // ...
}</code></pre>
<p>We can verify that <code>ck</code> provided in the puzzle data is indeed the commitment key returned by this function.
These two observations can be checked directly with</p>
<pre><code class="language-rust"><span class="boring">#![allow(unused, unreachable_code)]
</span><span class="boring">use ark_ed_on_bls12_381::Fr;
</span><span class="boring">use ark_ff::Field;
</span><span class="boring">use double_trouble::data::puzzle_data;
</span><span class="boring">use double_trouble::inner_product_argument::utils::challenge;
</span><span class="boring">use double_trouble::verify;
</span><span class="boring">use double_trouble::PUZZLE_DESCRIPTION;
</span><span class="boring">use prompt::{puzzle, welcome};
</span><span class="boring">
</span><span class="boring">// additional items brought into scope for puzzle solving
</span><span class="boring">use double_trouble::CommitKey;
</span><span class="boring">use ark_ec::AffineCurve;
</span><span class="boring">
</span><span class="boring">fn main() {
</span><span class="boring">    welcome();
</span><span class="boring">    puzzle(PUZZLE_DESCRIPTION);
</span><span class="boring">    let (ck, [instance_and_proof_1, instance_and_proof_2]) = puzzle_data();
</span><span class="boring">    let (instance1, proof1) = instance_and_proof_1;
</span><span class="boring">    let (instance2, proof2) = instance_and_proof_2;
</span><span class="boring">    assert!(verify(&amp;ck, &amp;instance1, &amp;proof1));
</span><span class="boring">    assert!(verify(&amp;ck, &amp;instance2, &amp;proof2));
</span><span class="boring">
</span><span class="boring">    // --snip--
</span><span class="boring">
</span><span class="boring">    println!("commitment key:");
</span><span class="boring">    for (i, ck_i) in ck.generators.iter().enumerate() {
</span><span class="boring">        println!("ck.generators[{}] = {}", i, ck_i);
</span><span class="boring">    }
</span><span class="boring">    println!("ck.hiding_generator = {}\n", ck.hiding_generator);
</span><span class="boring">    println!("instance 1, C_a:\n {}\n", instance1.comm_a);
</span><span class="boring">    println!("instance 2, C_a:\n {}\n", instance2.comm_a);
</span><span class="boring">    println!("instance 1, b:");
</span><span class="boring">    for (i, b_i) in instance1.b.iter().enumerate() {
</span><span class="boring">        println!("instance1.b[{}] = {}", i, b_i);
</span><span class="boring">    }
</span><span class="boring">    println!("");
</span><span class="boring">    println!("instance 2, b:");
</span><span class="boring">    for (i, b_i) in instance2.b.iter().enumerate() {
</span><span class="boring">        println!("instance2.b[{}] = {}", i, b_i);
</span><span class="boring">    }
</span><span class="boring">    println!("");
</span><span class="boring">
</span>    // --snip--

    assert_eq!(instance1, instance2);
    assert_eq!(ck, CommitKey::sample(8));
<span class="boring">
</span><span class="boring">    // --snip--
</span><span class="boring">
</span><span class="boring">    println!("proof1, comm_r:\n {}", proof1.commitment.comm_r);
</span><span class="boring">    println!("proof1, comm_1:\n {}", proof1.commitment.comm_1);
</span><span class="boring">    println!("proof1, comm_2:\n {}\n", proof1.commitment.comm_2);
</span><span class="boring">
</span><span class="boring">    println!("proof2, comm_r:\n {}", proof2.commitment.comm_r);
</span><span class="boring">    println!("proof2, comm_1:\n {}", proof2.commitment.comm_1);
</span><span class="boring">    println!("proof2, comm_2:\n {}\n", proof2.commitment.comm_2);
</span><span class="boring">
</span><span class="boring">    // --snip--
</span><span class="boring">
</span><span class="boring">    if proof1.commitment.comm_r.mul(2) == proof2.commitment.comm_r {
</span><span class="boring">        println!("C_r in the second proof is twice C_r in the first proof\n");
</span><span class="boring">    }
</span><span class="boring">
</span><span class="boring">    // --snip--
</span><span class="boring">
</span><span class="boring">    let gamma1 = challenge(&amp;ck, &amp;instance1, &amp;proof1.commitment);
</span><span class="boring">    let gamma2 = challenge(&amp;ck, &amp;instance2, &amp;proof2.commitment);
</span><span class="boring">    let s1 = proof1.response.s;
</span><span class="boring">    let s2 = proof2.response.s;
</span><span class="boring">    let u1 = proof1.response.u;
</span><span class="boring">    let u2 = proof2.response.u;
</span><span class="boring">    let k = (gamma1 - Fr::from(2) * gamma2).inverse().unwrap();
</span><span class="boring">    let my_a: Vec&lt;Fr&gt; = s1
</span><span class="boring">        .iter()
</span><span class="boring">        .zip(s2.iter())
</span><span class="boring">        .map(|(c1, c2)| k * (gamma1 * c2 - Fr::from(2) * gamma2 * c1))
</span><span class="boring">        .collect();
</span><span class="boring">    let my_comm_a_rand = k * (gamma1 * u2 - Fr::from(2) * gamma2 * u1);
</span><span class="boring">
</span><span class="boring">    let (a, comm_a_rand): (Vec&lt;Fr&gt;, Fr) = {
</span><span class="boring">        // Your solution here!
</span><span class="boring">        (my_a, my_comm_a_rand)
</span><span class="boring">    };
</span><span class="boring">    assert_eq!(
</span><span class="boring">        ck.commit_with_explicit_randomness(&amp;a, comm_a_rand),
</span><span class="boring">        instance1.comm_a
</span><span class="boring">    );
</span><span class="boring">    assert_eq!(
</span><span class="boring">        ck.commit_with_explicit_randomness(&amp;a, comm_a_rand),
</span><span class="boring">        instance2.comm_a
</span><span class="boring">    );
</span><span class="boring">    println!("Puzzle solved!");
</span><span class="boring">}</span></code></pre>
<p>(For this, one needs to derive the <code>PartialEq</code> trait for structures <code>CommitKey</code> and <code>Instance</code>).</p>
<p>As we explained in the section about <a href="../../cryptographic-notions/commitment-schemes.html#pedersen-commitments">Pedersen commitments</a>, the knowledge of discrete log relations between the group elements in the commitment key constitutes a trapdoor allowing to break the binding property of the commitment scheme.
However, this does not seem like a promising avenue to solve the puzzle.
On the one hand, this trapdoor does not allow to break the hiding property of the commitment scheme, which is what we would need to recover <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em;"></span><span class="mord mathbf">a</span><span class="mord">.</span></span></span></span>
On the other hand, function <code>sample</code> does things correctly by sampling uniformly random and independent group elements using a pseudorandom number generator seeded with NUMS string "zkHack IPA puzzle for 2021-10-26".</p>
<p>A side note about the code: in function <code>sample</code>, <code>generators</code> could be defined more simply as</p>
<pre><code class="language-rust">        let generators = sample_vector::&lt;GAffine, _&gt;(size, &amp;mut rng);</code></pre>
<p>Indeed, <code>sample_vector::&lt;GAffine, _&gt;(size, &amp;mut rng)</code> returns an object of type <code>Vec&lt;GAffine&gt;</code> so there is no need to apply <code>into</code> to each element.
On the other hand, there does not seem to be any good reason for sampling <code>hiding_generator</code> as a <code>GProjective</code> and then cast it into a <code>GAffine</code> using <code>into</code>.</p>

                        </div>
                        <div class="sidetoc">
                            <nav class="pagetoc"></nav>
                        </div>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../zk-hack-puzzles/puzzle-03/initial-inspection.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../zk-hack-puzzles/puzzle-03/solving-the-puzzle.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../zk-hack-puzzles/puzzle-03/initial-inspection.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../zk-hack-puzzles/puzzle-03/solving-the-puzzle.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../.././assets/mermaid.min.js"></script>
        <script src="../.././assets/mermaid-init.js"></script>
        <script src="../../theme/pagetoc.js"></script>


    </div>
    </body>
</html>