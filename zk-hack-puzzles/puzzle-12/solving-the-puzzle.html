<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Solving the Puzzle - Crypto Book (Work in Progress)</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../.././assets/custom.css">
        <link rel="stylesheet" href="../../theme/pagetoc.css">
        <link rel="stylesheet" href="../.././assets/mdbook-admonish.css">
        <link rel="stylesheet" href="../.././assets/mdbook-admonish-custom.css">

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "ayu" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item affix "><a href="../../intro.html">Introduction</a></li><li class="chapter-item affix "><li class="part-title">Mathematics</li><li class="chapter-item "><div><strong aria-hidden="true">1.</strong> Sets</div></li><li class="chapter-item "><div><strong aria-hidden="true">2.</strong> Integers</div></li><li class="chapter-item "><a href="../../mathematics/basic-arithmetic.html"><strong aria-hidden="true">3.</strong> Basic Arithmetic</a></li><li class="chapter-item "><div><strong aria-hidden="true">4.</strong> Modular Arithmetic</div></li><li class="chapter-item "><a href="../../mathematics/groups.html"><strong aria-hidden="true">5.</strong> Groups</a></li><li class="chapter-item "><div><strong aria-hidden="true">6.</strong> Rings</div></li><li class="chapter-item "><a href="../../mathematics/polynomials.html"><strong aria-hidden="true">7.</strong> Polynomials</a></li><li class="chapter-item "><div><strong aria-hidden="true">8.</strong> Fields</div></li><li class="chapter-item "><div><strong aria-hidden="true">9.</strong> Algorithms</div></li><li class="chapter-item "><div><strong aria-hidden="true">10.</strong> Fast Fourier Transform</div></li><li class="chapter-item "><a href="../../mathematics/elliptic-curves.html"><strong aria-hidden="true">11.</strong> Elliptic Curves</a></li><li class="chapter-item "><a href="../../mathematics/pairings.html"><strong aria-hidden="true">12.</strong> Pairings</a></li><li class="chapter-item affix "><li class="part-title">Cryptography</li><li class="chapter-item "><a href="../../cryptography/games-models-and-assumptions.html"><strong aria-hidden="true">13.</strong> Games, Models, and Assumptions</a></li><li class="chapter-item "><a href="../../cryptography/signatures-generalities.html"><strong aria-hidden="true">14.</strong> Signatures: Generalities</a></li><li class="chapter-item "><div><strong aria-hidden="true">15.</strong> Schnorr Signatures</div></li><li class="chapter-item "><div><strong aria-hidden="true">16.</strong> ECDSA Signatures</div></li><li class="chapter-item "><a href="../../cryptography/bls-signatures.html"><strong aria-hidden="true">17.</strong> BLS Signatures</a></li><li class="chapter-item "><a href="../../cryptography/commitment-schemes.html"><strong aria-hidden="true">18.</strong> Commitment Schemes</a></li><li class="chapter-item "><a href="../../cryptography/polynomial-commitment-schemes.html"><strong aria-hidden="true">19.</strong> Polynomial Commitment Schemes</a></li><li class="chapter-item affix "><li class="part-title">Proof Systems</li><li class="chapter-item "><div><strong aria-hidden="true">20.</strong> Languages and Complexity</div></li><li class="chapter-item "><div><strong aria-hidden="true">21.</strong> Interactive Proofs</div></li><li class="chapter-item "><div><strong aria-hidden="true">22.</strong> Zero-Knowledge Proofs</div></li><li class="chapter-item "><div><strong aria-hidden="true">23.</strong> Proofs of Knowledge</div></li><li class="chapter-item affix "><li class="part-title">ZK Hack Puzzles</li><li class="chapter-item "><a href="../../zk-hack-puzzles/before-starting.html"><strong aria-hidden="true">24.</strong> Before Starting</a></li><li class="chapter-item "><a href="../../zk-hack-puzzles/puzzle-01/intro.html"><strong aria-hidden="true">25.</strong> Puzzle 1: Let's Hash it Out</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../zk-hack-puzzles/puzzle-01/initial-inspection.html"><strong aria-hidden="true">25.1.</strong> Initial Inspection</a></li><li class="chapter-item "><a href="../../zk-hack-puzzles/puzzle-01/exploring-the-arkworks-libraries.html"><strong aria-hidden="true">25.2.</strong> Exploring the arkworks Libraries</a></li><li class="chapter-item "><a href="../../zk-hack-puzzles/puzzle-01/understanding-the-hash-to-curve-function.html"><strong aria-hidden="true">25.3.</strong> Understanding the hash-to-curve Function</a></li><li class="chapter-item "><a href="../../zk-hack-puzzles/puzzle-01/gathering-the-pieces.html"><strong aria-hidden="true">25.4.</strong> Gathering the Pieces</a></li></ol></li><li class="chapter-item "><a href="../../zk-hack-puzzles/puzzle-02/intro.html"><strong aria-hidden="true">26.</strong> Puzzle 2: Group Dynamics</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../zk-hack-puzzles/puzzle-02/initial-inspection.html"><strong aria-hidden="true">26.1.</strong> Initial Inspection</a></li><li class="chapter-item "><a href="../../zk-hack-puzzles/puzzle-02/small-subgroup-attacks.html"><strong aria-hidden="true">26.2.</strong> Small Subgroup Attacks</a></li><li class="chapter-item "><a href="../../zk-hack-puzzles/puzzle-02/solving-the-puzzle.html"><strong aria-hidden="true">26.3.</strong> Solving the Puzzle</a></li></ol></li><li class="chapter-item "><a href="../../zk-hack-puzzles/puzzle-03/intro.html"><strong aria-hidden="true">27.</strong> Puzzle 3: Double Trouble</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../zk-hack-puzzles/puzzle-03/initial-inspection.html"><strong aria-hidden="true">27.1.</strong> Initial Inspection</a></li><li class="chapter-item "><a href="../../zk-hack-puzzles/puzzle-03/exploring-the-code.html"><strong aria-hidden="true">27.2.</strong> Exploring the Code</a></li><li class="chapter-item "><a href="../../zk-hack-puzzles/puzzle-03/solving-the-puzzle.html"><strong aria-hidden="true">27.3.</strong> Solving the Puzzle</a></li></ol></li><li class="chapter-item "><div><strong aria-hidden="true">28.</strong> Puzzle 4: Hidden in Plain Sight</div></li><li class="chapter-item "><div><strong aria-hidden="true">29.</strong> Puzzle 5: To be Adaptive is to be Strong</div></li><li class="chapter-item "><div><strong aria-hidden="true">30.</strong> Puzzle 6: Soundness of Music</div></li><li class="chapter-item "><div><strong aria-hidden="true">31.</strong> Puzzle 7: There’s something in the AIR</div></li><li class="chapter-item "><div><strong aria-hidden="true">32.</strong> Puzzle 8: Can you turn up the heat?</div></li><li class="chapter-item "><div><strong aria-hidden="true">33.</strong> Puzzle 9: Zero-Sum Game</div></li><li class="chapter-item "><div><strong aria-hidden="true">34.</strong> Puzzle 10: Power Corrupts</div></li><li class="chapter-item "><div><strong aria-hidden="true">35.</strong> Puzzle 11: Bigger is Better</div></li><li class="chapter-item expanded "><a href="../../zk-hack-puzzles/puzzle-12/intro.html"><strong aria-hidden="true">36.</strong> Puzzle 12: Gamma Ray</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../zk-hack-puzzles/puzzle-12/code-analysis.html"><strong aria-hidden="true">36.1.</strong> Code Analysis</a></li><li class="chapter-item "><a href="../../zk-hack-puzzles/puzzle-12/understanding-the-spending-circuit.html"><strong aria-hidden="true">36.2.</strong> Understanding the Spending Circuit</a></li><li class="chapter-item expanded "><a href="../../zk-hack-puzzles/puzzle-12/solving-the-puzzle.html" class="active"><strong aria-hidden="true">36.3.</strong> Solving the Puzzle</a></li></ol></li><li class="chapter-item "><a href="../../zk-hack-puzzles/puzzle-13/puzzle-13.html"><strong aria-hidden="true">37.</strong> Puzzle 13: Supervillain</a></li><li class="chapter-item "><a href="../../zk-hack-puzzles/puzzle-14/puzzle-14.html"><strong aria-hidden="true">38.</strong> Puzzle 14: Chaos Theory</a></li><li class="chapter-item affix "><a href="../../references.html">References</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Crypto Book (Work in Progress)</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/yannickseurin/crypto-book" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <div class="content-wrap">
                            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h2 id="solving-the-puzzle"><a class="header" href="#solving-the-puzzle">Solving the Puzzle</a></h2>
<p>Recall that our task is to find another secret/nullifier pair that will satisfy the spending circuit.
We are not allowed to modify the Merkle root nor the Merkle proof, meaning this secret/nullifier pair must correspond to the exact same leaf of the Merkle tree.</p>
<p>But wait, the leaf does not really encode the public key <code>pk</code>, only its <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>-coordinate!
This is the key insight to solve the puzzle.
Indeed, for any point <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span> on the curve (different from the point at infinity), there is another point on the curve with the same <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>-coordinate, namely <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mord">.</span></span></span></span>
This point simply correspond to secret <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is the size of the scalar field of the MNT6-753 curve since <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">−</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">−</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mord mathnormal">G</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord">.</span></span></span></span></p>
<p>Hence, all we have to do to solve the puzzle is to take the opposite of <code>leaked_secret</code> mod <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and compute the corresponding nullifier!
There's a catch though: <code>leaked_secret</code> is defined as an element in the scalar field of MNT4-753, hence simply defining <code>secret_hack = - leaked_secret</code>  won't work as this will compute <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is the size of the scalar field of MNT4-753.</p>
<p>There are probably several options here, but a simple one is to cast <code>leaked_secret</code> as a big integer first.
For this, we need to add the <code>num-bigint</code> crate to the project:</p>
<pre><code class="language-console">$ cargo add num-bigint
</code></pre>
<p>Here is the code allowing to solve the puzzle:</p>
<pre><code class="language-rust"><span class="boring">use ark_ec::AffineRepr;
</span><span class="boring">use ark_ff::PrimeField;
</span><span class="boring">use ark_mnt4_753::{Fr as MNT4BigFr, MNT4_753};
</span><span class="boring">use ark_mnt6_753::G1Affine;
</span><span class="boring">use ark_mnt6_753::{constraints::G1Var, Fr as MNT6BigFr};
</span><span class="boring">
</span><span class="boring">use ark_crypto_primitives::merkle_tree::{Config, MerkleTree, Path};
</span><span class="boring">use ark_crypto_primitives::{crh::TwoToOneCRHScheme, snark::SNARK};
</span><span class="boring">use ark_groth16::Groth16;
</span><span class="boring">use ark_r1cs_std::fields::fp::FpVar;
</span><span class="boring">use ark_r1cs_std::prelude::*;
</span><span class="boring">use ark_relations::r1cs::{ConstraintSynthesizer, ConstraintSystemRef, SynthesisError};
</span><span class="boring">use ark_serialize::{CanonicalDeserialize, Read};
</span><span class="boring">
</span><span class="boring">use prompt::{puzzle, welcome};
</span><span class="boring">
</span><span class="boring">use std::fs::File;
</span><span class="boring">use std::io::Cursor;
</span><span class="boring">
</span><span class="boring">pub mod poseidon_parameters;
</span><span class="boring">
</span><span class="boring">type ConstraintF = MNT4BigFr;
</span><span class="boring">
</span><span class="boring">use ark_crypto_primitives::{
</span><span class="boring">    crh::{poseidon, *},
</span><span class="boring">    merkle_tree::constraints::*,
</span><span class="boring">    merkle_tree::*,
</span><span class="boring">};
</span><span class="boring">use ark_std::rand::SeedableRng;
</span><span class="boring">
</span><span class="boring">type LeafH = poseidon::CRH&lt;ConstraintF&gt;;
</span><span class="boring">type LeafHG = poseidon::constraints::CRHGadget&lt;ConstraintF&gt;;
</span><span class="boring">
</span><span class="boring">type CompressH = poseidon::TwoToOneCRH&lt;ConstraintF&gt;;
</span><span class="boring">type CompressHG = poseidon::constraints::TwoToOneCRHGadget&lt;ConstraintF&gt;;
</span><span class="boring">
</span><span class="boring">type LeafVar = [FpVar&lt;ConstraintF&gt;];
</span><span class="boring">struct MntMerkleTreeParamsVar;
</span><span class="boring">impl ConfigGadget&lt;MntMerkleTreeParams, ConstraintF&gt; for MntMerkleTreeParamsVar {
</span><span class="boring">    type Leaf = LeafVar;
</span><span class="boring">    type LeafDigest = &lt;LeafHG as CRHSchemeGadget&lt;LeafH, ConstraintF&gt;&gt;::OutputVar;
</span><span class="boring">    type LeafInnerConverter = IdentityDigestConverter&lt;FpVar&lt;ConstraintF&gt;&gt;;
</span><span class="boring">    type InnerDigest = &lt;CompressHG as TwoToOneCRHSchemeGadget&lt;CompressH, ConstraintF&gt;&gt;::OutputVar;
</span><span class="boring">    type LeafHash = LeafHG;
</span><span class="boring">    type TwoToOneHash = CompressHG;
</span><span class="boring">}
</span><span class="boring">
</span><span class="boring">type MntMerkleTree = MerkleTree&lt;MntMerkleTreeParams&gt;;
</span><span class="boring">
</span><span class="boring">struct MntMerkleTreeParams;
</span><span class="boring">
</span><span class="boring">impl Config for MntMerkleTreeParams {
</span><span class="boring">    type Leaf = [ConstraintF];
</span><span class="boring">
</span><span class="boring">    type LeafDigest = &lt;LeafH as CRHScheme&gt;::Output;
</span><span class="boring">    type LeafInnerDigestConverter = IdentityDigestConverter&lt;ConstraintF&gt;;
</span><span class="boring">    type InnerDigest = &lt;CompressH as TwoToOneCRHScheme&gt;::Output;
</span><span class="boring">
</span><span class="boring">    type LeafHash = LeafH;
</span><span class="boring">    type TwoToOneHash = CompressH;
</span><span class="boring">}
</span><span class="boring">
</span><span class="boring">#[derive(Clone)]
</span><span class="boring">struct SpendCircuit {
</span><span class="boring">    pub leaf_params: &lt;LeafH as CRHScheme&gt;::Parameters,
</span><span class="boring">    pub two_to_one_params: &lt;LeafH as CRHScheme&gt;::Parameters,
</span><span class="boring">    pub root: &lt;CompressH as TwoToOneCRHScheme&gt;::Output,
</span><span class="boring">    pub proof: Path&lt;MntMerkleTreeParams&gt;,
</span><span class="boring">    pub secret: ConstraintF,
</span><span class="boring">    pub nullifier: ConstraintF,
</span><span class="boring">}
</span><span class="boring">
</span><span class="boring">impl ConstraintSynthesizer&lt;ConstraintF&gt; for SpendCircuit {
</span><span class="boring">    fn generate_constraints(
</span><span class="boring">        self,
</span><span class="boring">        cs: ConstraintSystemRef&lt;ConstraintF&gt;,
</span><span class="boring">    ) -&gt; Result&lt;(), SynthesisError&gt; {
</span><span class="boring">        // Allocate Merkle Tree Root
</span><span class="boring">        let root = &lt;LeafHG as CRHSchemeGadget&lt;LeafH, _&gt;&gt;::OutputVar::new_input(
</span><span class="boring">            ark_relations::ns!(cs, "new_digest"),
</span><span class="boring">            || Ok(self.root),
</span><span class="boring">        )?;
</span><span class="boring">
</span><span class="boring">        // Allocate Parameters for CRH
</span><span class="boring">        let leaf_crh_params_var =
</span><span class="boring">            &lt;LeafHG as CRHSchemeGadget&lt;LeafH, _&gt;&gt;::ParametersVar::new_constant(
</span><span class="boring">                ark_relations::ns!(cs, "leaf_crh_parameter"),
</span><span class="boring">                &amp;self.leaf_params,
</span><span class="boring">            )?;
</span><span class="boring">        let two_to_one_crh_params_var =
</span><span class="boring">            &lt;CompressHG as TwoToOneCRHSchemeGadget&lt;CompressH, _&gt;&gt;::ParametersVar::new_constant(
</span><span class="boring">                ark_relations::ns!(cs, "two_to_one_crh_parameter"),
</span><span class="boring">                &amp;self.two_to_one_params,
</span><span class="boring">            )?;
</span><span class="boring">
</span><span class="boring">        let secret = FpVar::new_witness(ark_relations::ns!(cs, "secret"), || Ok(self.secret))?;
</span><span class="boring">        let secret_bits = secret.to_bits_le()?;
</span><span class="boring">        Boolean::enforce_smaller_or_equal_than_le(&amp;secret_bits, MNT6BigFr::MODULUS)?;
</span><span class="boring">
</span><span class="boring">        let nullifier = &lt;LeafHG as CRHSchemeGadget&lt;LeafH, _&gt;&gt;::OutputVar::new_input(
</span><span class="boring">            ark_relations::ns!(cs, "nullifier"),
</span><span class="boring">            || Ok(self.nullifier),
</span><span class="boring">        )?;
</span><span class="boring">
</span><span class="boring">        let nullifier_in_circuit =
</span><span class="boring">            &lt;LeafHG as CRHSchemeGadget&lt;LeafH, _&gt;&gt;::evaluate(&amp;leaf_crh_params_var, &amp;[secret])?;
</span><span class="boring">        nullifier_in_circuit.enforce_equal(&amp;nullifier)?;
</span><span class="boring">
</span><span class="boring">        let base = G1Var::new_constant(ark_relations::ns!(cs, "base"), G1Affine::generator())?;
</span><span class="boring">        let pk = base.scalar_mul_le(secret_bits.iter())?.to_affine()?;
</span><span class="boring">
</span><span class="boring">        // Allocate Leaf
</span><span class="boring">        let leaf_g: Vec&lt;_&gt; = vec![pk.x];
</span><span class="boring">
</span><span class="boring">        // Allocate Merkle Tree Path
</span><span class="boring">        let cw: PathVar&lt;MntMerkleTreeParams, ConstraintF, MntMerkleTreeParamsVar&gt; =
</span><span class="boring">            PathVar::new_witness(ark_relations::ns!(cs, "new_witness"), || Ok(&amp;self.proof))?;
</span><span class="boring">
</span><span class="boring">        cw.verify_membership(
</span><span class="boring">            &amp;leaf_crh_params_var,
</span><span class="boring">            &amp;two_to_one_crh_params_var,
</span><span class="boring">            &amp;root,
</span><span class="boring">            &amp;leaf_g,
</span><span class="boring">        )?
</span><span class="boring">        .enforce_equal(&amp;Boolean::constant(true))?;
</span><span class="boring">
</span><span class="boring">        Ok(())
</span><span class="boring">    }
</span><span class="boring">}
</span><span class="boring">
</span><span class="boring">fn from_file&lt;T: CanonicalDeserialize&gt;(path: &amp;str) -&gt; T {
</span><span class="boring">    let mut file = File::open(path).unwrap();
</span><span class="boring">    let mut buffer = Vec::new();
</span><span class="boring">    file.read_to_end(&amp;mut buffer).unwrap();
</span><span class="boring">    T::deserialize_uncompressed_unchecked(Cursor::new(&amp;buffer)).unwrap()
</span><span class="boring">}
</span><span class="boring">
</span><span class="boring">fn main() {
</span><span class="boring">    welcome();
</span><span class="boring">    puzzle(PUZZLE_DESCRIPTION);
</span><span class="boring">
</span><span class="boring">    let rng = &amp;mut ark_std::rand::rngs::StdRng::seed_from_u64(0u64);
</span><span class="boring">
</span><span class="boring">    let leaves: Vec&lt;Vec&lt;MNT4BigFr&gt;&gt; = from_file("./leaves.bin");
</span><span class="boring">    let leaked_secret: MNT4BigFr = from_file("./leaked_secret.bin");
</span><span class="boring">    let (pk, vk): (
</span><span class="boring">        &lt;Groth16&lt;MNT4_753&gt; as SNARK&lt;MNT4BigFr&gt;&gt;::ProvingKey,
</span><span class="boring">        &lt;Groth16&lt;MNT4_753&gt; as SNARK&lt;MNT4BigFr&gt;&gt;::VerifyingKey,
</span><span class="boring">    ) = from_file("./proof_keys.bin");
</span><span class="boring">
</span><span class="boring">    let leaf_crh_params = poseidon_parameters::poseidon_parameters();
</span><span class="boring">    let i = 2;
</span><span class="boring">    let two_to_one_crh_params = leaf_crh_params.clone();
</span><span class="boring">
</span><span class="boring">    let nullifier = &lt;LeafH as CRHScheme&gt;::evaluate(&amp;leaf_crh_params, vec![leaked_secret]).unwrap();
</span><span class="boring">
</span><span class="boring">    let tree = MntMerkleTree::new(
</span><span class="boring">        &amp;leaf_crh_params,
</span><span class="boring">        &amp;two_to_one_crh_params,
</span><span class="boring">        leaves.iter().map(|x| x.as_slice()),
</span><span class="boring">    )
</span><span class="boring">    .unwrap();
</span><span class="boring">    let root = tree.root();
</span><span class="boring">    let leaf = &amp;leaves[i];
</span><span class="boring">
</span><span class="boring">    let tree_proof = tree.generate_proof(i).unwrap();
</span><span class="boring">    assert!(tree_proof
</span><span class="boring">        .verify(
</span><span class="boring">            &amp;leaf_crh_params,
</span><span class="boring">            &amp;two_to_one_crh_params,
</span><span class="boring">            &amp;root,
</span><span class="boring">            leaf.as_slice()
</span><span class="boring">        )
</span><span class="boring">        .unwrap());
</span><span class="boring">
</span><span class="boring">    let c = SpendCircuit {
</span><span class="boring">        leaf_params: leaf_crh_params.clone(),
</span><span class="boring">        two_to_one_params: two_to_one_crh_params.clone(),
</span><span class="boring">        root: root.clone(),
</span><span class="boring">        proof: tree_proof.clone(),
</span><span class="boring">        nullifier: nullifier.clone(),
</span><span class="boring">        secret: leaked_secret.clone(),
</span><span class="boring">    };
</span><span class="boring">
</span><span class="boring">    let proof = Groth16::&lt;MNT4_753&gt;::prove(&amp;pk, c.clone(), rng).unwrap();
</span><span class="boring">
</span><span class="boring">    // --snip--
</span><span class="boring">
</span><span class="boring">    for (i, leaf) in leaves.iter().enumerate() {
</span><span class="boring">        for (j, p) in leaf.iter().enumerate() {
</span><span class="boring">            println!("leaves[{}][{}]: {}", i, j, p);
</span><span class="boring">        }
</span><span class="boring">    }
</span><span class="boring">    println!("");
</span><span class="boring">
</span><span class="boring">    assert!(Groth16::&lt;MNT4_753&gt;::verify(&amp;vk, &amp;vec![root, nullifier], &amp;proof).unwrap());
</span><span class="boring">
</span>    // --snip--

    /* Enter your solution here */

    // cast leaked_secret as big integer...
    let s: num_bigint::BigUint = leaked_secret.into();
    // ... and then as an element of MNT6BigFr
    let s_as_mnt6bigfr = MNT6BigFr::from_le_bytes_mod_order(&amp;s.to_bytes_le());
    // take the opposite and cast it again as a big integer...
    let secret_hack_as_bigint: num_bigint::BigUint = (-s_as_mnt6bigfr).into();
    // and finally cast it back to an element of MNT4BigFr
    let secret_hack = MNT4BigFr::from_le_bytes_mod_order(&amp;secret_hack_as_bigint.to_bytes_le());
    // compute the corresponding nullifier
    let nullifier_hack =
        &lt;LeafH as CRHScheme&gt;::evaluate(&amp;leaf_crh_params, vec![secret_hack]).unwrap();
    println!("nullifier_hack: {}", nullifier_hack);
    println!("secret_hack: {}", secret_hack_as_bigint);

    /* End of solution */
<span class="boring">
</span><span class="boring">    assert_ne!(nullifier, nullifier_hack);
</span><span class="boring">
</span><span class="boring">    let c2 = SpendCircuit {
</span><span class="boring">        leaf_params: leaf_crh_params.clone(),
</span><span class="boring">        two_to_one_params: two_to_one_crh_params.clone(),
</span><span class="boring">        root: root.clone(),
</span><span class="boring">        proof: tree_proof.clone(),
</span><span class="boring">        nullifier: nullifier_hack.clone(),
</span><span class="boring">        secret: secret_hack.clone(),
</span><span class="boring">    };
</span><span class="boring">
</span><span class="boring">    let proof = Groth16::&lt;MNT4_753&gt;::prove(&amp;pk, c2.clone(), rng).unwrap();
</span><span class="boring">
</span><span class="boring">    assert!(Groth16::&lt;MNT4_753&gt;::verify(&amp;vk, &amp;vec![root, nullifier_hack], &amp;proof).unwrap());
</span><span class="boring">
</span><span class="boring">    println!("Puzzle solved!");
</span><span class="boring">}
</span><span class="boring">
</span><span class="boring">const PUZZLE_DESCRIPTION: &amp;str = r"
</span><span class="boring">Bob was deeply inspired by the Zcash design [1] for private transactions [2] and had some pretty cool ideas on how to adapt it for his requirements. He was also inspired by the Mina design for the lightest blockchain and wanted to combine the two. In order to achieve that, Bob used the MNT7653 cycle of curves to enable efficient infinite recursion, and used elliptic curve public keys to authorize spends. He released a first version of the system to the world and Alice soon announced she was able to double spend by creating two different nullifiers for the same key... 
</span><span class="boring">
</span><span class="boring">[1] https://zips.z.cash/protocol/protocol.pdf
</span><span class="boring">";</span></code></pre>
<h3 id="a-note-about-hint-1"><a class="header" href="#a-note-about-hint-1">A Note about Hint 1</a></h3>
<p>The first hint revealed to help solve the puzzle points to Lemma 5.4.7 of the <a href="https://zips.z.cash/protocol/protocol.pdf">Zcash specifications</a>.
It reads:</p>
<blockquote>
<p>Let <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0547em;vertical-align:-0.1667em;"></span><span class="mord"><span class="mord mathbb">J</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mord">.</span></span></span></span> Then <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mord"><span class="mrel">∈</span></span><span class="mord vbox"><span class="thinbox"><span class="llap"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="inner"><span class="mord"><span class="mord">/</span><span class="mspace" style="margin-right:0.0556em;"></span></span></span><span class="fix"></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0547em;vertical-align:-0.1667em;"></span><span class="mord"><span class="mord mathbb">J</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mord">.</span></span></span></span></p>
</blockquote>
<p>Here, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0547em;vertical-align:-0.1667em;"></span><span class="mord"><span class="mord mathbb">J</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span> is (a subgroup of) the Jubjub curve developed by the ZCash team.
Its base field is actually the scalar field of BLS12-381, allowing to efficiently prove algebraic statements about this curve using BLS12-381-based SNARKs.</p>
<p>The reason why the "attack" used to solve the puzzle would not apply with this curve is that it is a twisted Edwards curve rather than a curve in short Weierstrass form.
In particular, Theorem 5.4.8 in the same document states that the function mapping points in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0547em;vertical-align:-0.1667em;"></span><span class="mord"><span class="mord mathbb">J</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span> to their <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>-coordinate is injective, meaning two distinct points have distinct <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>-coordinates.
In this case, it is safe to encode a point by recording only its <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>-coordinate in a leaf.</p>

                        </div>
                        <div class="sidetoc">
                            <nav class="pagetoc"></nav>
                        </div>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../zk-hack-puzzles/puzzle-12/understanding-the-spending-circuit.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../zk-hack-puzzles/puzzle-13/puzzle-13.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../zk-hack-puzzles/puzzle-12/understanding-the-spending-circuit.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../zk-hack-puzzles/puzzle-13/puzzle-13.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../.././assets/mermaid.min.js"></script>
        <script src="../.././assets/mermaid-init.js"></script>
        <script src="../../theme/pagetoc.js"></script>


    </div>
    </body>
</html>